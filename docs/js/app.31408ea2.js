(function(e){function t(t){for(var o,i,r=t[0],l=t[1],c=t[2],u=0,p=[];u<r.length;u++)i=r[u],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&p.push(s[i][0]),s[i]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);d&&d(t);while(p.length)p.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,r=1;r<n.length;r++){var l=n[r];0!==s[l]&&(o=!1)}o&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},s={app:0},a=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=l;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"034f":function(e,t,n){"use strict";n("d1bb")},5024:function(e,t,n){"use strict";n("649c")},"56e0":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="56e0"},"649c":function(e,t,n){},bb3e:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);var o=n("56ba"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container-fluid",attrs:{id:"app"}},[n("div",{staticClass:"row"},[n("Dialog")],1)])},a=[],i=n("d9c4"),r=n("5dd6"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"col-xs-12"},[n("div",{staticClass:"row line"},[n("form",{staticClass:"form-inline",attrs:{onsubmit:"return false"}},[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"peerIdInput"}},[e._v("Peer ID:")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.selfPeerId,expression:"selfPeerId"}],staticClass:"form-control",attrs:{id:"peerIdInput",type:"text",readonly:""},domProps:{value:e.selfPeerId},on:{input:function(t){t.target.composing||(e.selfPeerId=t.target.value)}}})]),e._v(" "),e.selfPeerId?n("button",{staticClass:"btn btn-default",attrs:{id:"copySelfPeerId"}},[e._v("Copy")]):e._e()])]),n("div",{staticClass:"row line"},[n("form",{staticClass:"form-inline",attrs:{onsubmit:"return false"}},[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"friendPeerIdInput"}},[e._v("Friend peer ID:")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.friendPeerId,expression:"friendPeerId"}],staticClass:"form-control",attrs:{id:"friendPeerIdInput"},domProps:{value:e.friendPeerId},on:{input:function(t){t.target.composing||(e.friendPeerId=t.target.value)}}})]),e._v(" "),e.selfPeerId?n("input",{staticClass:"btn btn-default",attrs:{type:"button",value:"Connect"},on:{click:e.connectPeer}}):e._e()])]),n("div",{staticClass:"row line"},[n("label",{staticStyle:{margin:"0"}},[e._v("Status: ")]),n("span",[e._v(e._s(e.status))]),n("button",{staticClass:"btn btn-default pull-right",attrs:{type:"button","data-toggle":"button","aria-pressed":"false",autocomplete:"off"},on:{click:e.toggleScrollingLock}},[e._v("Scroll Lock")])]),n("div",{staticClass:"row line"},[n("div",{staticClass:"col-xs-12",attrs:{id:"messagesContainer"}},e._l(e.messageList,(function(t,o){return n("p",{key:o,staticClass:"message"},[n("span",{staticClass:"messageName"},[e._v(e._s(t.name))]),e._v(": "),"img"===t.type?[n("br"),n("img",{staticClass:"messageImage",attrs:{src:t.content},on:{load:e.onImageLoad}})]:[n("span",{staticClass:"messageText",domProps:{innerHTML:e._s(t.content)}})]],2)})),0)]),n("div",{staticClass:"row line"},[n("input",{staticClass:"btn btn-default",attrs:{type:"button",value:"Image"},on:{click:e.selectImages}})]),n("div",{staticClass:"row line"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"form-control col-xs-12",attrs:{cols:"45",rows:"4"},domProps:{value:e.message},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:(t.stopPropagation(),e.sendMessage(t)):null},input:function(t){t.target.composing||(e.message=t.target.value)}}})]),n("div",{staticClass:"row line"},[n("input",{staticClass:"btn btn-default",attrs:{type:"button",value:"Send"},on:{click:e.sendMessage}})]),n("div",{staticClass:"row line"},[n("label",{staticStyle:{margin:"0"}},[e._v("Call status: ")]),n("span",[e._v(e._s(e.callStatus)+" ")]),n("input",{staticClass:"btn btn-default",attrs:{type:"button",value:"Toggle Call"},on:{click:e.toggleCall}}),e._v(" "),n("label",{staticClass:"checkbox-inline"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.isVideoEnabled,expression:"isVideoEnabled"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isVideoEnabled)?e._i(e.isVideoEnabled,null)>-1:e.isVideoEnabled},on:{change:function(t){var n=e.isVideoEnabled,o=t.target,s=!!o.checked;if(Array.isArray(n)){var a=null,i=e._i(n,a);o.checked?i<0&&(e.isVideoEnabled=n.concat([a])):i>-1&&(e.isVideoEnabled=n.slice(0,i).concat(n.slice(i+1)))}else e.isVideoEnabled=s}}}),e._v("Use Video ")]),n("label",{staticClass:"checkbox-inline"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.isCameraEnabled,expression:"isCameraEnabled"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isCameraEnabled)?e._i(e.isCameraEnabled,null)>-1:e.isCameraEnabled},on:{change:function(t){var n=e.isCameraEnabled,o=t.target,s=!!o.checked;if(Array.isArray(n)){var a=null,i=e._i(n,a);o.checked?i<0&&(e.isCameraEnabled=n.concat([a])):i>-1&&(e.isCameraEnabled=n.slice(0,i).concat(n.slice(i+1)))}else e.isCameraEnabled=s}}}),e._v("Use Camera ")])]),e._m(0),n("input",{attrs:{type:"file",id:"imageInput",multiple:""},on:{change:e.sendImages}}),n("audio",{attrs:{id:"speaker",autoplay:""}},[e._v('Your browser can not support "audio" elements.')])])},c=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row line"},[n("video",{staticClass:"col-xs-12",attrs:{id:"player",autoplay:"",controls:""}},[e._v('Your browser can not support "video" elements.')])])}],d=n("9c48"),u=n("1d05"),p=n.n(u),f=n("e4d9"),m=n.n(f),g=n("00eb"),b=n.n(g),h=function(){function e(e,t,n){this.type=e,this.name=t,this.content=n}return e}(),v=function(e){function t(){var t=e.call(this)||this;t.friendPeerId="",t.selfPeerId="",t.status="getting peer ID...",t.message="",t.messageList=[],t.clipboard=null,t.conn=null,t.isScrollingLocked=!1,t.mediaConnection=null,t._mediaSource=null,t.callStatus="disconnected",t.isVideoEnabled=!1,t.isCameraEnabled=!1;var n=t;t.clipboard=new b.a("#copySelfPeerId",{text:function(e){return n.getSelfPeerId()}});var o=navigator;return t.getUserMedia=o.getUserMedia||o.webkitGetUserMedia||o.mozGetUserMedia,t.peer=new m.a,t.peer.on("open",t.onPeerOpen),t.peer.on("connection",t.onPeerConnection),t.peer.on("call",t.onPeerCall),t}return Object(i["b"])(t,e),t.prototype.getSelfPeerId=function(){return this.selfPeerId},t.prototype.onPeerOpen=function(e){this.selfPeerId=e,this.status="online"},t.prototype.onPeerConnection=function(e){null==this.conn?(this.conn=e,e.on("open",this.onConnOpen),e.on("close",this.onConnClose),e.on("data",this.onConnData)):e.close()},t.prototype.onConnOpen=function(){null!=this.conn&&(this.friendPeerId=this.conn.peer,this.status="connected")},t.prototype.onConnClose=function(){this.status="disconnected"},t.prototype.escapeText=function(e){return d["a"](e).replace(/\n/g,"<br>").replace(/ /g,"&nbsp;").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;")},t.prototype.onConnData=function(e){if("img"===e.type){var t=new Blob([e.content],{type:e.fileType}),n=URL.createObjectURL(t);this.messageList.push(new h("img","friend",n))}else{var o=this.escapeText(e.content);this.messageList.push(new h("text","friend",o))}},t.prototype.connectPeer=function(){null==this.conn&&(this.status="connecting...",this.onPeerConnection(this.peer.connect(this.friendPeerId)))},t.prototype.sendMessage=function(){null!=this.conn&&(this.messageList.push(new h("text","me",this.escapeText(this.message))),this.conn.send({type:"text",content:this.message}),this.message="")},t.prototype.sendImages=function(e){var t=e.target;if(null!=t.files){var n=this.conn;if(null!=n)for(var o=function(e){var o=t.files[e],a=URL.createObjectURL(o);s.messageList.push(new h("img","me",a));var i=new FileReader;i.onload=function(e){null!=e.target&&n.send({type:"img",content:e.target.result,fileType:o.type})},i.readAsArrayBuffer(o)},s=this,a=0;a<t.files.length;++a)o(a)}},t.prototype.onImageLoad=function(e){this.scrollBottom();var t=e.target.src;t.startsWith("blob:")&&window.URL.revokeObjectURL(t)},t.prototype.selectImages=function(){p()("#imageInput").click()},t.prototype.getMediaSource=function(){return this._mediaSource},t.prototype.setMediaSource=function(e){this._mediaSource=e;var t=document.querySelector(this.isVideoEnabled?"#player":"#speaker");t.srcObject=e},t.prototype.toggleCall=function(){var e,t=this;if(null!=this.getMediaSource())null===(e=this.mediaConnection)||void 0===e||e.close(),this.setMediaSource(null),this.callStatus="disconnected";else{if(null==this.conn)return;this.getUserMedia({video:!!this.isCameraEnabled&&{facingMode:"user"},audio:!0},(function(e){t.callStatus="connecting...",t.mediaConnection=t.peer.call(t.friendPeerId,e),t.mediaConnection.on("error",console.error),t.mediaConnection.on("close",(function(){t.setMediaSource(null),t.callStatus="disconnected"})),t.mediaConnection.on("stream",(function(e){t.setMediaSource(e),t.callStatus="connected"}))}),(function(e){console.log("Failed to get local stream.",e),window.alert("Failed to get local stream.")}))}},t.prototype.onPeerCall=function(e){var t,n=this;e.peer==this.friendPeerId&&window.confirm("Answer the call?")?(null===(t=this.mediaConnection)||void 0===t||t.close(),null!=this.getMediaSource()&&this.setMediaSource(null),this.callStatus="disconnected",this.getUserMedia({video:!!this.isCameraEnabled&&{facingMode:"user"},audio:!0},(function(t){n.mediaConnection=e,n.callStatus="answering...",n.mediaConnection.answer(t),n.mediaConnection.on("error",console.error),n.mediaConnection.on("close",(function(){n.setMediaSource(null),n.callStatus="disconnected"})),n.mediaConnection.on("stream",(function(e){n.setMediaSource(e),n.callStatus="connected"}))}),(function(t){e.close(),console.log("Failed to get local stream.",t),window.alert("Failed to get local stream.")}))):e.close()},t.prototype.scrollBottom=function(){this.isScrollingLocked||p()("#messagesContainer").scrollTop(p()("#messagesContainer")[0].scrollHeight)},t.prototype.toggleScrollingLock=function(){this.isScrollingLocked=!this.isScrollingLocked},t.prototype.onMessageListChanged=function(e,t){var n=e[e.length-1].type;"text"===n&&setTimeout(this.scrollBottom,0)},t.prototype.onVideoToggled=function(e,t){e?p()("#player").show():p()("#player").hide()},Object(i["a"])([Object(r["c"])("messageList")],t.prototype,"onMessageListChanged",null),Object(i["a"])([Object(r["c"])("isVideoEnabled")],t.prototype,"onVideoToggled",null),t=Object(i["a"])([r["a"]],t),t}(r["b"]),y=v,C=y,w=(n("5024"),n("3583")),_=Object(w["a"])(C,l,c,!1,null,"48975f96",null),P=_.exports,S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i["b"])(t,e),t=Object(i["a"])([Object(r["a"])({components:{Dialog:P}})],t),t}(r["b"]),I=S,k=I,x=(n("034f"),Object(w["a"])(k,s,a,!1,null,null,null)),O=x.exports;n("bb3e"),n("8d70"),n("f40d"),n("ff3b");o["a"].config.productionTip=!1,new o["a"]({render:function(e){return e(O)}}).$mount("#app")},d1bb:function(e,t,n){}});